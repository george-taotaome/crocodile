# Crocodile Distributed Task Scheduling System 

## Introduction
A distributed task scheduling system based on Golang that supports http requests, run golang、python、python3、shell、bat

```          
                                                  +----------+
        +-------------+                           ||--------||
        ||-----------||                           ||        ||
        ||           ||                           || Worker ||
        ||   调度中心 ||                           ||         ||
        ||           ||      RPC调用(gRPC)        ||---------||
        ||-----------|| +-----------------------> ||-------- ||
        ||-----------||                           ||        ||
        ||           || <-----------------------+ || Worker ||
  +---> ||   调度中心 ||      任务实时日志            ||        ||
任 |    ||           ||                           ||--------||
务 |    ||-----------|| <------+                  ||--------||
完 |     +------------+        |                  ||        ||
成 |         ^    |            |                  || Worker ||
持 |       实|任   |            |数                ||        ||                
久 |       时|务   |获          |据                 +----------+ 
日 |       志|状   |取          |存                
志 |       日|态   |锁          |储
   |        v     v            v
   |      +-------+-+      +----+---+
   |      |         |      |        |
   +----- |  Redis  |      | MySQL  |
          |         |      |        |
          +---------+      +--------+
```

## Features
- Add, modify, delete, clone and run tasks on the web node  
- View real-time logs of running tasks and tasks in real time, and can terminate running tasks  
- Multiple task types:  
    - Perform `http` request tasks  
    - Run `shell`,` python`, `golang`、`python3`、`nodejs`codes (of course other languages ​​can also be supported, please provide if necessary)  
- Father and child tasks:  
    When the parent task or child task is set, the `parent task`->` main task`-> `subtask` will be run first. If any task fails, the entire process will be interrupted immediately. You can also set the parent task or subtask` `Or` serial` run
- Scheduling Algorithm:    
    Supports four scheduling algorithms: random, rotation, worker weight, minimum worker number to call Worker to run tasks,
- Custom alarm strategy:  
    Can be set to alert multiple users when the task `success`,` failure`, or `run is completed`  
    Set the return code or return content of the task to compare whether the actual return code or return content of the task is the same to determine whether the task runs successfully.
- Host group:    
    A task can only be bound to any host group. The running of the task will select a task in this host group to run the task through the task's routing strategy
- Host:  
    A host group can be bound to multiple hosts, the host is the node that actually runs the task, and the dispatch center automatically discovers after registration
- security strategy    
    Certificate encryption encrypts communication data
    Access token
- Task log management, clean up logs  
- Alarm notification support platform  
    - Mail  
    - WeChat  
    - DingDing  
    - Slack Channel  
    - Telegram Bot  
    - WebHook URL  
- Detailed task audit function  
    All operations on data changes to users will be recorded
- Permission control 
    - Administrator  
        Have all operating rights    
    - general user  
        New tasks and host groups can be created, but only tasks or host groups that have been created can be operated, but audit records and all users cannot be viewed    
    - Guest  
    Only viewing authority, no operation modification authority, but can not view audit records, all users

## Development
- Frontend
    - Install `yarn`  
    - Go to the web directory, first download the dependency `yarn`, and then run the front-end` yarn run dev` separately   
    - Package to go, execute `make frontrnd`,
- Backend  
    - Run `make runs` as a schdeule center
    - Run `make runc` as worker node
> The sql directory is also packaged in `go-bindata`. During installation, the sql creation statement will be read from the file generated by` go-bindata`. If the sql is modified, re-execute `make bin-data`

## License
Crocodile is under the MIT license. See the [LICENSE](./LICENSE) file for details.